(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{13:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return g}));var r=n(19),c=n.n(r),a=n(24),i=n(20),u=n.n(i),o=n(1);u.a.defaults.baseURL="https://connections-api.herokuapp.com/";var s,l=function(e){u.a.defaults.headers.common.Authorization="Bearer ".concat(e)},d=function(){u.a.defaults.headers.common.Authorization=""},j=Object(o.c)("auth/register",function(){var e=Object(a.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.post("/users/signup",t);case 3:return n=e.sent,r=n.data,l(r.token),e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),b=Object(o.c)("auth/login",function(){var e=Object(a.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.post("/users/login",t);case 3:return n=e.sent,r=n.data,l(r.token),e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),h={register:j,logOut:Object(o.c)("auth/logout",Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.post("/users/logout");case 3:d(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),logIn:b,fetchCurrentUser:Object(o.c)("auth/refresh",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState(),null!==(a=r.auth.token)){e.next=5;break}return console.log("\u0422\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u0442, \u0443\u0445\u043e\u0434\u0438\u043c \u0438\u0437 fetchCurrentUser"),e.abrupt("return",n.rejectWithValue());case 5:return l(a),e.prev=6,e.next=9,u.a.get("/users/current");case 9:return i=e.sent,o=i.data,e.abrupt("return",o);case 14:e.prev=14,e.t0=e.catch(6);case 16:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}())},f={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUsername:function(e){return e.auth.user.name},getIsFetchingCurrent:function(e){return e.auth.isFetchingCurrentUser}},p=n(15),g=Object(o.d)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrentUser:!1},extraReducers:(s={},Object(p.a)(s,h.register.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(p.a)(s,h.logIn.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(p.a)(s,h.logOut.fulfilled,(function(e){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(p.a)(s,h.fetchCurrentUser.pending,(function(e){e.isFetchingCurrentUser=!0})),Object(p.a)(s,h.fetchCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0,e.isFetchingCurrentUser=!1})),Object(p.a)(s,h.fetchCurrentUser.rejected,(function(e){e.isFetchingCurrentUser=!1})),s)}).reducer},26:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return u}));var r=n(43),c=n(7),a=Object(r.a)({reducerPath:"items",baseQuery:Object(c.d)({baseUrl:"https://60ad63bf80a61f0017330e5e.mockapi.io/api/v1/"}),tagTypes:["Contact"],endpoints:function(e){return{fetchContacts:e.query({query:function(){return"/contacts"},providesTags:["Contact"]}),deleteContact:e.mutation({query:function(e){return{url:"/contacts/".concat(e),method:"DELETE"}},invalidatesTags:["Contact"]}),createContact:e.mutation({query:function(e){return{url:"/contacts",method:"POST",body:e}},invalidatesTags:["Contact"]})}}}),i=a.useFetchContactsQuery,u=a.useDeleteContactMutation;a.useCreateContactMutation},72:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(25),c=n.n(r),a=n(0),i=n.n(a),u=n(5),o=n(17),s=n(44),l=n(15),d=n(1),j=n(7),b=n(26),h=n(13),f=Object(l.a)({auth:h.b},b.a.reducerPath,b.a.reducer),p=Object(d.a)({reducer:f,middleware:function(e){return[].concat(Object(s.a)(e()),[b.a.middleware])},devTools:!1});Object(j.e)(p.dispatch);var g=p,O=(n(72),n(6)),v=n(2),x={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},m=function(){return Object(v.jsx)("nav",{children:Object(v.jsx)(o.b,{to:"/",exact:!0,style:x.link,activeStyle:x.activeLink,children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"})})},y=n.p+"static/media/default-avatar.e44fc4e2.png",k={container:{display:"flex",alignItems:"center"},avatar:{marginRight:4},name:{fontWeight:700,marginRight:12}};function C(){var e=Object(u.d)(),t=Object(u.e)(h.c.getUsername),n=y;return Object(v.jsxs)("div",{style:k.container,children:[Object(v.jsx)("img",{src:n,alt:"",width:"32",style:k.avatar}),Object(v.jsxs)("span",{style:k.name,children:["\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c, ",t]}),Object(v.jsx)("button",{type:"button",onClick:function(){return e(h.a.logOut())},children:"\u0412\u044b\u0439\u0442\u0438"})]})}var I={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}};function w(){return Object(v.jsxs)("div",{children:[Object(v.jsx)(o.b,{to:"/register",exact:!0,style:I.link,activeStyle:I.activeLink,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(v.jsx)(o.b,{to:"/login",exact:!0,style:I.link,activeStyle:I.activeLink,children:"\u041b\u043e\u0433\u0438\u043d"})]})}var L={header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #2A363B"}};function U(){var e=Object(u.e)(h.c.getIsLoggedIn);return Object(v.jsxs)("header",{style:L.header,children:[Object(v.jsx)(m,{}),e?Object(v.jsx)(C,{}):Object(v.jsx)(w,{})]})}var F=n(18),T=n(27);var S=["children","restricted","redirectTo"];function A(e){var t=e.children,n=e.restricted,r=void 0!==n&&n,c=e.redirectTo,a=void 0===c?"/":c,i=Object(T.a)(e,S),o=Object(u.e)(h.c.getIsLoggedIn)&&r;return Object(v.jsx)(O.b,Object(F.a)(Object(F.a)({},i),{},{children:o?Object(v.jsx)(O.a,{to:a}):t}))}var B=Object(a.lazy)((function(){return n.e(6).then(n.bind(null,80))})),E=Object(a.lazy)((function(){return n.e(5).then(n.bind(null,81))})),z=Object(a.lazy)((function(){return n.e(4).then(n.bind(null,82))}));function q(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(U,{}),Object(v.jsx)(O.d,{children:Object(v.jsxs)(a.Suspense,{fallback:Object(v.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c..."}),children:[Object(v.jsx)(A,{exact:!0,path:"/",children:Object(v.jsx)(B,{})}),Object(v.jsx)(A,{exact:!0,path:"/register",restricted:!0,children:Object(v.jsx)(E,{})}),Object(v.jsx)(A,{exact:!0,path:"/login",redirectTo:"/todos",restricted:!0,children:Object(v.jsx)(z,{})})]})})]})}c.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(u.a,{store:g,children:Object(v.jsx)(o.a,{children:Object(v.jsx)(q,{})})})}),document.getElementById("root"))}},[[78,1,2]]]);
//# sourceMappingURL=main.45125d1f.chunk.js.map